\documentclass{article}
\usepackage{newtxtext}
\usepackage{amssymb}
\usepackage[noend]{algpseudocode}
\usepackage{algorithmicx,algorithm}
\pagestyle{empty} %取消页码
\begin{document}
\begin{algorithm}[t]
	\caption{Ghost Backdoor based on neuron select} %算法的名字
	\hspace*{0.02in} {\bf Input:} %算法的输入， \hspace*{0.02in}用来控制位置，同时利用 \\ 进行换行
	{central server $C_s$, a set of all client $C$, current epoch $e$, end epoch $E_e$,
    current client $C_i$, learning rate $\eta$, benign datasets $D$, 
    mask matrix $\mathbb{R}_{mask}^{r\times d}$
    ghost neurons' values matrix $\mathbb{R}_{V_s}^{r\times d}$}\\
	\hspace*{0.02in} {\bf Output:} %算法的结果输出
	a global model with high accuracy, ghost backdoor and high accuracy in main-task


	\begin{algorithmic}[1]

	\State $C_s$ select $n$ clients by random into $C_n$ % \State 后写一般语句
	\State $C_s$ build a global model $G$
	\State $C_s$ send $G$ to each client in $C_n$
    \State choose the ghost neurons 
    \State pre-train with benign samples to collect the values of every neurons
    \State choose $V_s$ as trigger
	\For{$e$ \textless \enspace $E_e$}
		\For{the $k$-th client $C^k_e$ in $C_n$}
			
			\State Download $G$ as local model $L$ and train by $D$, 
			\State Compute gradient by ${D}$ on batch $B_i$ of size $\ell$
			\State $ g^k_{e+1} = \frac{1}{\ell}\sum_{i = 1}^{\ell}\nabla_\theta \mathcal{L}(\theta_{C^k_e}, D) $
            \If {client $C_i$ is advisary \textbf{and} epoch mod $N_{attack}$ = 0} % For 语句，需要和EndFor对应
                \State $ \hat{g}^k_{e+1} = g^k_{e+1} * \mathbb{R}_{mask}^{r\times d} + \mathbb{R}_{V_s}^{r\times d}$
                \State Update $ \theta_{C^k_{e+1}} = \theta_{C^k_e} - \eta \hat{g}^k_{e+1} $
            \Else
			\State Update $ \theta_{C^k_{e+1}} = \theta_{C^k_e} - \eta g^k_{e+1} $
            \EndIf
            \State Upload $ \theta_{C^k_{e+1}}$ to $C_s $
		\EndFor
		\State $C_s$ recieve $ \sum_1^k \theta_{C^k_{e+1}}$ and generate update $U_{e+1}$ for $G_{last}$

	\State $G = G_{last} - U_{e+1}$
	\EndFor
	\Return Final global model $G$ with backdoor
	\end{algorithmic}


\end{algorithm}
\end{document}